(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[586],{70489:function(V){V.exports={border_less_wrapper:"border_less_wrapper___1qmff","rule-row":"rule-row___3sQ3P"}},27607:function(V){V.exports={main:"main___14D0P",border_less_wrapper:"border_less_wrapper___34OGj"}},36363:function(V,W,t){"use strict";t.r(W),t.d(W,{default:function(){return me}});var ye=t(20228),_=t(11382),je=t(57663),L=t(60404),xe=t(48736),ee=t(27049),ne=t(38310),P=t(67294),re=t(27607),ae=t.n(re),Ze=t(89032),b=t(15746),Re=t(58024),Y=t(39144),Oe=t(13062),w=t(71230),N=t(2824),z=t(49101),Se=t(47673),oe=t(1011),Ge=t(43358),A=t(34041),O=t(11849),B=t(1058),e=t(85893),te=function(n){var u=n.variables,p=n.operators,r=n.ruleCondition,y=n.showMinus,C=n.onChange,j=n.onDelete,g=r,h=function(o){C==null||C((0,O.Z)({},o))},v=[],c={},x=new Map;u.forEach(function(a){var o={label:a.name,value:a.code};v.push(o),x.set(a.code,a),a.id==g.leftId&&(c={label:a.name,value:a.code})});var S=function(o){var l=x.get(o),i=l?l.id:null;h((0,O.Z)((0,O.Z)({},g),{},{leftId:i}))},Z=[],f={},G=new Map;p.forEach(function(a){var o={label:a.name,value:a.code};Z.push(o),G.set(a.code,a),a.code==g.operatorCode&&(f={label:a.name,value:a.code})});var E=function(o){h((0,O.Z)((0,O.Z)({},g),{},{operatorCode:o}))},D=function(o){var l=o.target.value;h((0,O.Z)((0,O.Z)({},g),{},{rightValue:l}))},R=function(o){j(o)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Z,{span:10,children:(0,e.jsx)(A.Z,{showSearch:!0,style:{width:200},placeholder:"Variable",optionFilterProp:"label",filterOption:function(o,l){return l.label.toLowerCase().indexOf(o.toLowerCase())>=0},filterSort:function(o,l){return o.label.toLowerCase().localeCompare(l.label.toLowerCase())},options:v,defaultValue:c,onChange:S})}),(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(A.Z,{showSearch:!0,style:{width:100},placeholder:"Operator",optionFilterProp:"children",filterOption:function(o,l){return l.label.toLowerCase().indexOf(o.toLowerCase())>=0},filterSort:function(o,l){return o.label.toLowerCase().localeCompare(l.label.toLowerCase())},options:Z,defaultValue:f,onChange:E})}),(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(oe.Z,{placeholder:"value",value:g.rightValue,onChange:D})}),(0,e.jsx)(b.Z,{span:2,children:(0,e.jsx)(w.Z,{gutter:16,children:(0,e.jsx)(b.Z,{children:y&&(0,e.jsx)(L.Z,{type:"primary",shape:"circle",icon:(0,e.jsx)(B.Z,{}),onClick:R})})})})]})},le=te,ie=function(n){var u=n.logicOps,p=n.logic,r=n.onChange,y=(0,P.useState)(p),C=(0,N.Z)(y,2),j=C[0],g=C[1],h=function(f){r==null||r(f)},v=function(f){g(f),h(f)},c=[],x={},S=new Map;return u.forEach(function(Z,f){var G={label:Z,value:f};c.push(G),S.set(f,G),j&&f.toUpperCase()==j.toUpperCase()&&(x={label:Z,value:f})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(A.Z,{style:{width:100},placeholder:"Select",options:c,defaultValue:x,onChange:v})})},K=ie,se=t(86582),ue=t(70489),X=t.n(ue),ce=t(96486),M=function(){return Math.ceil(Math.random()*1e4)+"_"+(0,ce.now)()},pe=function(n){for(var u=n.variables,p=n.operators,r=n.logicOps,y=n.ruleGroup,C=n.showHeadMinus,j=n.onChange,g=n.onDelete,h=(0,P.useState)(y),v=(0,N.Z)(h,2),c=v[0],x=v[1],S=function(i){j==null||j(i)},Z=function(i,d){var m=Object.assign([],c);m[i]=d,x(m),S(m)},f=function(i,d){var m=Object.assign([],c);m.splice(i,1),x(m),S(m)},G=function(i,d){var m=Object.assign([],c);m[i].logicCode=d,x(m),S(m)},E=function(i){var d=[].concat((0,se.Z)(c),[{_key:M()}]);x(d),S(d)},D=function(i){g==null||g(i)},R=[],a=function(i){var d=c[i],m=!1;i!=0&&(R.push((0,e.jsx)(w.Z,{gutter:16,style:{margin:10},children:(0,e.jsx)(b.Z,{children:(0,e.jsx)(K,{logicOps:r,logic:d.logicCode,onChange:function(T){return G(i,T)}},d._key)})})),m=!0),R.push((0,e.jsx)(w.Z,{gutter:16,style:{margin:10},children:(0,e.jsx)(le,{variables:u,operators:p,ruleCondition:d,showMinus:m,onChange:function(T){return Z(i,T)},onDelete:function(T){return f(i,T)}},d._key)}))},o=0;o<c.length;o++)a(o);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Y.Z,{title:(0,e.jsxs)("div",{children:["Rule Group",C&&(0,e.jsx)(L.Z,{type:"primary",shape:"circle",icon:(0,e.jsx)(B.Z,{}),onClick:D,style:{marginLeft:10}})]}),bordered:!0,children:[R,(0,e.jsx)(w.Z,{gutter:16,justify:"center",style:{margin:10},children:(0,e.jsx)(b.Z,{span:24,children:(0,e.jsx)(L.Z,{type:"primary",block:!0,icon:(0,e.jsx)(z.Z,{}),onClick:function(i){return E(i)}})})})]})})},de=pe,ge=function(n){for(var u=n.variables,p=n.operators,r=n.logicOps,y=n.rule,C=n.onChange,j=(0,P.useState)(y),g=(0,N.Z)(j,2),h=g[0],v=g[1],c=function(a){C==null||C(a)},x=function(a,o){var l=Object.assign([],h);l[a].ruleConditions=o,v(l),c(l)},S=function(a){var o=Object.assign([],h);o.splice(a,1),v(o),c(o)},Z=function(a,o){var l=Object.assign([],h);l[a].logicCode=o,v(l),c(l)},f=function(a){var o={_key:M(),logicCode:"and"},l={_key:M(),logicCode:"and",ruleConditions:[]};l.ruleConditions.push(o);var i=Object.assign([],h);i.push(l),v(i),c(i)},G=[],E=function(a){var o=h[a],l=!1;a!=0&&(G.push((0,e.jsx)(w.Z,{style:{marginTop:24},children:(0,e.jsx)(b.Z,{children:(0,e.jsx)(K,{logicOps:r,logic:o.logicCode,onChange:function(d){return Z(a,d)}},o._key)})})),l=!0),G.push((0,e.jsx)(w.Z,{children:(0,e.jsx)(b.Z,{span:24,children:(0,e.jsx)(de,{variables:u,operators:p,logicOps:r,ruleGroup:o.ruleConditions,showHeadMinus:l,onChange:function(d){return x(a,d)},onDelete:function(d){return S(a,d)}},o._key)})}))},D=0;D<h.length;D++)E(D);return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Y.Z,{title:(0,e.jsxs)("div",{children:["Rule ",(0,e.jsx)(L.Z,{type:"primary",shape:"circle",icon:(0,e.jsx)(z.Z,{}),onClick:f})]}),className:X().card,bordered:!1,children:(0,e.jsx)(w.Z,{align:"middle",justify:"center",children:(0,e.jsx)("div",{className:X().border_less_wrapper,children:G})})})})},ve=ge;function be(){var s=useState(0),n=_slicedToArray(s,2),u=n[1],p=useCallback(function(){u(function(r){return r+1})},[]);return p}var k=t(3182),he=t(94043),F=t.n(he),H=t(48971);function fe(s,n){return I.apply(this,arguments)}function I(){return I=(0,k.Z)(F().mark(function s(n,u){return F().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,H.WY)("/api/ruleedit",(0,O.Z)({method:"GET",params:(0,O.Z)({},n)},u||{})));case 1:case"end":return r.stop()}},s)})),I.apply(this,arguments)}function we(s,n){return $.apply(this,arguments)}function $(){return $=_asyncToGenerator(_regeneratorRuntime.mark(function s(n,u){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/rulequery",_objectSpread({method:"GET",params:_objectSpread({},n)},u||{})));case 1:case"end":return r.stop()}},s)})),$.apply(this,arguments)}function De(s,n){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime.mark(function s(n,u){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/variables",_objectSpread({method:"GET",params:_objectSpread({},n)},u||{})));case 1:case"end":return r.stop()}},s)})),U.apply(this,arguments)}function Le(s,n){return J.apply(this,arguments)}function J(){return J=_asyncToGenerator(_regeneratorRuntime.mark(function s(n,u){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/operators",_objectSpread({method:"GET",params:_objectSpread({},n)},u||{})));case 1:case"end":return r.stop()}},s)})),J.apply(this,arguments)}function Ce(s,n){return Q.apply(this,arguments)}function Q(){return Q=(0,k.Z)(F().mark(function s(n,u){return F().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,H.WY)("/api/rulechange",(0,O.Z)({data:n,method:"POST"},u||{})));case 1:case"end":return r.stop()}},s)})),Q.apply(this,arguments)}var me=function(){var s=(0,H.QT)(function(){return fe({uuid:"96668402-87fc-11ec-a8a3-0242ac120002"})}),n=s.error,u=s.loading,p=s.data,r=u?{}:p.rule,y=u?[]:r.ruleGroups;y==null||y.forEach(function(v){v._key=M(),v.ruleConditions.forEach(function(c){c._key=M()})});var C={OR:"OR",AND:"AND"},j=new Map(Object.entries(C)),g=function(c){r.ruleGroups=c},h=function(){var c=JSON.stringify(r);console.log("rule:",c),Ce(r)};return(0,e.jsx)(ne.ZP,{content:"\u7B56\u7565\u7F16\u8F91",className:ae().main,children:(0,e.jsx)("div",{children:(0,e.jsx)(_.Z,{spinning:u,size:"large",delay:300,children:!u&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ve,{variables:p.variablesArray,operators:p.operatorsArray,logicOps:j,rule:y,onChange:g}),(0,e.jsx)(ee.Z,{children:" Process Action "}),(0,e.jsx)(L.Z,{type:"primary",htmlType:"submit",onClick:h,children:"Submit"})]})})})})}}}]);
